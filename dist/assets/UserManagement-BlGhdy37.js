import{d as ae,e as b,l as S,f as $,m as le,c as te,a,w as t,r as u,b as f,q as oe,i as p,v as ne,k as q,t as B,h as L,E as w,x as se,o as U,_ as re}from"./index-76Zfp96_.js";const ue={class:"user-management"},de={class:"card-header"},ie={style:{float:"right"}},me={class:"filter-section"},pe={style:{"margin-left":"10px"}},ge={style:{"margin-left":"10px"}},ce={class:"dialog-footer"},fe=ae({__name:"UserManagement",setup(ve){const k=b(!1),s=S({name:"",status:"",role:""}),d=S({currentPage:1,pageSize:10}),v=b(!1),z=b(""),V=b(!1),n=S({id:0,username:"",name:"",email:"",role:"",password:"",confirmPassword:"",status:"enabled"}),M={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度应在3-20个字符之间",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:10,message:"姓名长度应在2-10个字符之间",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度应在6-20个字符之间",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(o,e,r)=>{e!==n.password?r(new Error("两次输入的密码不一致")):r()},trigger:"blur"}]},y=b(),g=b([{id:1,username:"admin",name:"管理员",email:"admin@example.com",role:"admin",lastLogin:"2023-06-07 14:30:25",status:"enabled"},{id:2,username:"operator1",name:"运营人员1",email:"operator1@example.com",role:"operator",lastLogin:"2023-06-07 10:15:32",status:"enabled"},{id:3,username:"analyst1",name:"分析师1",email:"analyst1@example.com",role:"analyst",lastLogin:"2023-06-06 16:42:18",status:"enabled"},{id:4,username:"operator2",name:"运营人员2",email:"operator2@example.com",role:"operator",lastLogin:"2023-06-05 09:25:47",status:"disabled"}]),D=$(()=>g.value.filter(o=>(s.name===""||o.username.includes(s.name)||o.name.includes(s.name))&&(s.status===""||o.status===s.status)&&(s.role===""||o.role===s.role))),h=$(()=>{const o=(d.currentPage-1)*d.pageSize,e=o+d.pageSize;return D.value.slice(o,e)}),F=()=>{d.currentPage=1,w.success("查询成功")},I=()=>{s.name="",s.status="",s.role="",d.currentPage=1},T=o=>{d.pageSize=o,d.currentPage=1},N=o=>{d.currentPage=o},j=()=>{z.value="新增用户",V.value=!1,v.value=!0},O=o=>{z.value="编辑用户",V.value=!0,Object.assign(n,o),v.value=!0},R=()=>{Object.assign(n,{id:0,username:"",name:"",email:"",role:"",password:"",confirmPassword:"",status:"enabled"}),y.value&&y.value.resetFields()},A=o=>{const e=o.status==="enabled"?"启用":"停用";w.success(`已${e}用户 "${o.name}"`)},G=()=>{y.value.validate(o=>{if(o){if(V.value){const e=g.value.findIndex(r=>r.id===n.id);e!==-1&&(g.value[e]={...n},w.success("用户更新成功"))}else{const e=Math.max(...g.value.map(r=>r.id),0)+1;g.value.push({...n,id:e,lastLogin:"从未登录"}),w.success("用户添加成功")}v.value=!1}})},H=o=>{se.confirm(`确定要删除用户 "${o.name}" 吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=g.value.findIndex(r=>r.id===o.id);e!==-1&&(g.value.splice(e,1),w.success("删除成功"))}).catch(()=>{w.info("已取消删除")})};return le(()=>{k.value=!0,setTimeout(()=>{k.value=!1},500)}),(o,e)=>{const r=u("el-button"),_=u("el-input"),x=u("el-col"),i=u("el-option"),P=u("el-select"),J=u("el-row"),m=u("el-table-column"),K=u("el-tag"),E=u("el-switch"),Q=u("el-table"),W=u("el-pagination"),X=u("el-card"),c=u("el-form-item"),Y=u("el-form"),Z=u("el-dialog"),ee=ne("loading");return U(),te("div",ue,[a(X,{class:"main-card"},{header:t(()=>[f("div",de,[e[15]||(e[15]=f("span",null,"用户管理",-1)),f("div",ie,[a(r,{type:"primary",onClick:j},{default:t(()=>[...e[14]||(e[14]=[p("新增用户",-1)])]),_:1})])])]),default:t(()=>[f("div",me,[a(J,{gutter:20},{default:t(()=>[a(x,{span:6},{default:t(()=>[a(_,{modelValue:s.name,"onUpdate:modelValue":e[0]||(e[0]=l=>s.name=l),placeholder:"用户名/姓名",clearable:""},null,8,["modelValue"])]),_:1}),a(x,{span:6},{default:t(()=>[a(P,{modelValue:s.status,"onUpdate:modelValue":e[1]||(e[1]=l=>s.status=l),placeholder:"状态",clearable:"",style:{width:"100%"}},{default:t(()=>[a(i,{label:"启用",value:"enabled"}),a(i,{label:"停用",value:"disabled"})]),_:1},8,["modelValue"])]),_:1}),a(x,{span:6},{default:t(()=>[a(P,{modelValue:s.role,"onUpdate:modelValue":e[2]||(e[2]=l=>s.role=l),placeholder:"角色",clearable:"",style:{width:"100%"}},{default:t(()=>[a(i,{label:"管理员",value:"admin"}),a(i,{label:"运营人员",value:"operator"}),a(i,{label:"数据分析师",value:"analyst"})]),_:1},8,["modelValue"])]),_:1}),a(x,{span:6},{default:t(()=>[a(r,{type:"primary",onClick:F},{default:t(()=>[...e[16]||(e[16]=[p("查询",-1)])]),_:1}),a(r,{onClick:I},{default:t(()=>[...e[17]||(e[17]=[p("重置",-1)])]),_:1})]),_:1})]),_:1})]),oe((U(),q(Q,{data:h.value,style:{width:"100%","margin-top":"20px"},border:""},{default:t(()=>[a(m,{prop:"id",label:"ID",width:"80"}),a(m,{prop:"username",label:"用户名",width:"150"}),a(m,{prop:"name",label:"姓名",width:"120"}),a(m,{prop:"email",label:"邮箱",width:"200"}),a(m,{prop:"role",label:"角色",width:"120"},{default:t(l=>[a(K,{type:l.row.role==="admin"?"danger":l.row.role==="operator"?"primary":"success"},{default:t(()=>[p(B(l.row.role==="admin"?"管理员":l.row.role==="operator"?"运营人员":"数据分析师"),1)]),_:2},1032,["type"])]),_:1}),a(m,{prop:"lastLogin",label:"最后登录时间",width:"180"}),a(m,{prop:"status",label:"状态",width:"100"},{default:t(l=>[a(E,{modelValue:l.row.status,"onUpdate:modelValue":C=>l.row.status=C,"active-value":"enabled","inactive-value":"disabled",onChange:C=>A(l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"]),f("span",pe,B(l.row.status==="enabled"?"启用":"停用"),1)]),_:1}),a(m,{label:"操作",width:"200"},{default:t(l=>[a(r,{size:"small",onClick:C=>O(l.row)},{default:t(()=>[...e[18]||(e[18]=[p("编辑",-1)])]),_:1},8,["onClick"]),a(r,{size:"small",type:"danger",onClick:C=>H(l.row)},{default:t(()=>[...e[19]||(e[19]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ee,k.value]]),a(W,{"current-page":d.currentPage,"onUpdate:currentPage":e[3]||(e[3]=l=>d.currentPage=l),"page-size":d.pageSize,"onUpdate:pageSize":e[4]||(e[4]=l=>d.pageSize=l),"page-sizes":[10,20,50,100],total:D.value.length,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:T,onCurrentChange:N,style:{"margin-top":"20px","text-align":"right"}},null,8,["current-page","page-size","total"])]),_:1}),a(Z,{title:z.value,modelValue:v.value,"onUpdate:modelValue":e[13]||(e[13]=l=>v.value=l),width:"600px",onClose:R},{footer:t(()=>[f("span",ce,[a(r,{onClick:e[12]||(e[12]=l=>v.value=!1)},{default:t(()=>[...e[20]||(e[20]=[p("取消",-1)])]),_:1}),a(r,{type:"primary",onClick:G},{default:t(()=>[...e[21]||(e[21]=[p("保存",-1)])]),_:1})])]),default:t(()=>[a(Y,{model:n,rules:M,ref_key:"userForm",ref:y,"label-width":"100px"},{default:t(()=>[a(c,{label:"用户名",prop:"username"},{default:t(()=>[a(_,{modelValue:n.username,"onUpdate:modelValue":e[5]||(e[5]=l=>n.username=l)},null,8,["modelValue"])]),_:1}),a(c,{label:"姓名",prop:"name"},{default:t(()=>[a(_,{modelValue:n.name,"onUpdate:modelValue":e[6]||(e[6]=l=>n.name=l)},null,8,["modelValue"])]),_:1}),a(c,{label:"邮箱",prop:"email"},{default:t(()=>[a(_,{modelValue:n.email,"onUpdate:modelValue":e[7]||(e[7]=l=>n.email=l)},null,8,["modelValue"])]),_:1}),a(c,{label:"角色",prop:"role"},{default:t(()=>[a(P,{modelValue:n.role,"onUpdate:modelValue":e[8]||(e[8]=l=>n.role=l),style:{width:"100%"}},{default:t(()=>[a(i,{label:"管理员",value:"admin"}),a(i,{label:"运营人员",value:"operator"}),a(i,{label:"数据分析师",value:"analyst"})]),_:1},8,["modelValue"])]),_:1}),V.value?L("",!0):(U(),q(c,{key:0,label:"密码",prop:"password"},{default:t(()=>[a(_,{modelValue:n.password,"onUpdate:modelValue":e[9]||(e[9]=l=>n.password=l),type:"password"},null,8,["modelValue"])]),_:1})),V.value?L("",!0):(U(),q(c,{key:1,label:"确认密码",prop:"confirmPassword"},{default:t(()=>[a(_,{modelValue:n.confirmPassword,"onUpdate:modelValue":e[10]||(e[10]=l=>n.confirmPassword=l),type:"password"},null,8,["modelValue"])]),_:1})),a(c,{label:"状态"},{default:t(()=>[a(E,{modelValue:n.status,"onUpdate:modelValue":e[11]||(e[11]=l=>n.status=l),"active-value":"enabled","inactive-value":"disabled"},null,8,["modelValue"]),f("span",ge,B(n.status==="enabled"?"启用":"停用"),1)]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}}),be=re(fe,[["__scopeId","data-v-760c1235"]]);export{be as default};
