import{d as L,e as u,l as $,m as M,c as j,b as g,a as t,w as s,r as m,i as p,u as q,p as P,A,x as F,E as h,o as G,_ as H}from"./index-76Zfp96_.js";const K={class:"indicator-theme-list"},Q={class:"header"},W={class:"pagination"},X={class:"dialog-footer"},Y=L({__name:"IndicatorThemeList",setup(Z){const d=u([]),y=()=>{const a=JSON.parse(localStorage.getItem("indicatorThemeReports")||"[]");a.length>0?d.value=a:(d.value=[{id:1,name:"销售业绩汇总表",alias:"sales_summary",description:"展示各区域销售业绩情况",creator:"张三",createTime:"2023-06-01 10:00:00",modifier:"李四",modifyTime:"2023-06-15 14:30:00"},{id:2,name:"用户活跃度分析表",alias:"user_activity",description:"分析用户活跃度变化趋势",creator:"王五",createTime:"2023-06-05 09:15:00",modifier:"赵六",modifyTime:"2023-06-18 16:45:00"},{id:3,name:"产品销量排行表",alias:"product_ranking",description:"展示各产品销量排行榜",creator:"孙七",createTime:"2023-06-10 11:20:00",modifier:"周八",modifyTime:"2023-06-20 13:10:00"}],localStorage.setItem("indicatorThemeReports",JSON.stringify(d.value))),c.value=d.value.length},v=u(1),_=u(10),c=u(3),f=u(!1),I=u(""),w=u(!1),r=$({id:0,name:"",alias:"",description:"",creator:"",createTime:"",modifier:"",modifyTime:""}),C={name:[{required:!0,message:"请输入报表名称",trigger:"blur"}],alias:[{required:!0,message:"请输入报表别名",trigger:"blur"}]},S=A(),x=u(),V=()=>{S.push("/indicator-theme-design/editor/new")},R=a=>{S.push(`/indicator-theme-design/editor/${a.id}`)},k=a=>{F.confirm(`确定要删除指标主题汇总表 "${a.name}" 吗？`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=d.value.findIndex(o=>o.id===a.id);if(e!==-1){d.value.splice(e,1),c.value--,h.success("删除成功");const o=JSON.parse(localStorage.getItem("indicatorThemeReports")||"[]"),i=o.findIndex(n=>n.id===a.id);i!==-1&&(o.splice(i,1),localStorage.setItem("indicatorThemeReports",JSON.stringify(o)))}}).catch(()=>{})},N=()=>{x.value.validate(a=>{if(a){if(w.value){const e=d.value.findIndex(o=>o.id===r.id);if(e!==-1){r.modifier="当前用户",r.modifyTime=new Date().toLocaleString(),Object.assign(d.value[e],r),h.success("编辑成功");const o=JSON.parse(localStorage.getItem("indicatorThemeReports")||"[]"),i=o.findIndex(n=>n.id===r.id);i!==-1&&(o[i]=d.value[e],localStorage.setItem("indicatorThemeReports",JSON.stringify(o)))}}else{const e=JSON.parse(localStorage.getItem("indicatorThemeReports")||"[]"),o=e.length>0?Math.max(...e.map(n=>n.id))+1:1,i={...r,id:o,creator:"当前用户",createTime:new Date().toLocaleString(),modifier:"当前用户",modifyTime:new Date().toLocaleString()};d.value.push(i),c.value++,h.success("创建成功"),e.push(i),localStorage.setItem("indicatorThemeReports",JSON.stringify(e))}f.value=!1}})},z=a=>{_.value=a},O=a=>{v.value=a};return M(()=>{y()}),(a,e)=>{const o=m("el-icon"),i=m("el-button"),n=m("el-table-column"),J=m("el-table"),D=m("el-pagination"),b=m("el-input"),T=m("el-form-item"),B=m("el-form"),U=m("el-dialog");return G(),j("div",K,[g("div",Q,[e[8]||(e[8]=g("h2",null,"指标主题汇总表管理",-1)),t(i,{type:"primary",onClick:V},{default:s(()=>[t(o,null,{default:s(()=>[t(q(P))]),_:1}),e[7]||(e[7]=p(" 新建指标主题汇总表 ",-1))]),_:1})]),t(J,{data:d.value,class:"theme-table",border:""},{default:s(()=>[t(n,{prop:"name",label:"报表名称",width:"150"}),t(n,{prop:"alias",label:"报表别名",width:"150"}),t(n,{prop:"description",label:"描述"}),t(n,{prop:"creator",label:"创建人",width:"120"}),t(n,{prop:"createTime",label:"创建时间",width:"180"}),t(n,{prop:"modifier",label:"最近修改人",width:"120"}),t(n,{prop:"modifyTime",label:"最近修改时间",width:"180"}),t(n,{label:"操作",width:"150",fixed:"right"},{default:s(l=>[t(i,{size:"small",onClick:E=>R(l.row)},{default:s(()=>[...e[9]||(e[9]=[p("设计",-1)])]),_:1},8,["onClick"]),t(i,{size:"small",type:"danger",onClick:E=>k(l.row)},{default:s(()=>[...e[10]||(e[10]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),g("div",W,[t(D,{"current-page":v.value,"onUpdate:currentPage":e[0]||(e[0]=l=>v.value=l),"page-size":_.value,"onUpdate:pageSize":e[1]||(e[1]=l=>_.value=l),"page-sizes":[10,20,50,100],total:c.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:z,onCurrentChange:O},null,8,["current-page","page-size","total"])]),t(U,{modelValue:f.value,"onUpdate:modelValue":e[6]||(e[6]=l=>f.value=l),title:I.value,width:"600px"},{footer:s(()=>[g("span",X,[t(i,{onClick:e[5]||(e[5]=l=>f.value=!1)},{default:s(()=>[...e[11]||(e[11]=[p("取消",-1)])]),_:1}),t(i,{type:"primary",onClick:N},{default:s(()=>[...e[12]||(e[12]=[p("确定",-1)])]),_:1})])]),default:s(()=>[t(B,{model:r,rules:C,ref_key:"formRef",ref:x,"label-width":"120px"},{default:s(()=>[t(T,{label:"报表名称",prop:"name"},{default:s(()=>[t(b,{modelValue:r.name,"onUpdate:modelValue":e[2]||(e[2]=l=>r.name=l)},null,8,["modelValue"])]),_:1}),t(T,{label:"报表别名",prop:"alias"},{default:s(()=>[t(b,{modelValue:r.alias,"onUpdate:modelValue":e[3]||(e[3]=l=>r.alias=l)},null,8,["modelValue"])]),_:1}),t(T,{label:"描述",prop:"description"},{default:s(()=>[t(b,{modelValue:r.description,"onUpdate:modelValue":e[4]||(e[4]=l=>r.description=l),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),te=H(Y,[["__scopeId","data-v-6f1d7055"]]);export{te as default};
